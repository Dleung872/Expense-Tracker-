def expense_calculation():
    """
    Calculate and display total expenses and perâ€‘category breakdown.
    Uses the global expense_categories dictionary.
    """
    total = 0.0                     # Initialize total expenses
    category_totals = {}             # Dictionary to store totals per category

    # Loop through each category and its list of expense strings
    for category, expenses in expense_categories.items():
        cat_total = 0.0               # Total for this category

        # Loop through each expense entry in the category
        for exp_str in expenses:
            try:
                # Split the string into description and the rest using " - $"
                # Example: "Lunch - $12.50 on 2025/03/17"
                parts = exp_str.split(' - $')
                if len(parts) == 2:
                    # The second part contains the amount and date: "12.50 on 2025/03/17"
                    # Further split by " on " to isolate the amount
                    amount_part = parts[1].split(' on ')[0]   # Extract amount as string
                    amount = float(amount_part)               # Convert to float
                    total += amount                            # Add to global total
                    cat_total += amount                        # Add to category total
            except (ValueError, IndexError):
                # If parsing fails (e.g., malformed string), print a warning and continue
                print(f"Warning: could not parse expense entry: {exp_str}")

        # If the category has any valid expenses, store its total
        if cat_total > 0:
            category_totals[category] = cat_total

    # Clear the screen (optional, comment out if not needed)
    os.system('clear')

    # Print the summary
    print("\n=== Expense Summary ===")
    print(f"Total expenses: ${total:.2f}")

    if category_totals:
        print("\nPer Category:")
        for cat, amt in category_totals.items():
            print(f"  {cat}: ${amt:.2f}")
    else:
        print("No expenses recorded.")

    # Pause so the user can see the results before returning to the menu
    input("\nPress Enter to return to main menu...")
